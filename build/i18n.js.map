{"version":3,"sources":["webpack://[name]/webpack/universalModuleDefinition","webpack://[name]/webpack/bootstrap","webpack://[name]/webpack/runtime/define property getters","webpack://[name]/webpack/runtime/hasOwnProperty shorthand","webpack://[name]/./src/index.ts","webpack://[name]/./src/loadjson.ts"],"names":["root","factory","exports","module","define","amd","self","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","i18n","option","this","locale","baseURL","elTag","suffix","assign","langMap","messages","langlib","load","url","Promise","resolve","reject","test","rawFile","XMLHttpRequest","overrideMimeType","open","onreadystatechange","readyState","status","JSON","parse","responseText","statusText","send","window","script","document","createElement","type","src","head","appendChild","onload","a","_export","onerror","remove","setLanguage","language","_this","run","bind","re","then","callback","success","error","d","catch","err","destroy","t","s","setting","list","split","_loop_1","i","L","k","x_1","_k","replace","match","$1","length","h","hands","stringify","fonts","querySelectorAll","Array","from","forEach","el","getAttribute","opt","innerText"],"mappings":"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","file":"i18n.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"i18n\"] = factory();\n\telse\n\t\troot[\"i18n\"] = factory();\n})(self, function() {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }",";\r\nimport loadJson from './loadjson';\r\nvar i18n = /** @class */ (function () {\r\n    function i18n(option) {\r\n        if (option === void 0) { option = {}; }\r\n        this.locale = option.locale;\r\n        this.baseURL = option.baseURL;\r\n        this.elTag = option.elTag || 'font';\r\n        this.suffix = option.suffix || 'json';\r\n        Object.assign(i18n.langMap, option.messages || {});\r\n        if (this.locale && i18n.langMap[this.locale]) {\r\n            this.langlib = i18n.langMap[this.locale];\r\n        }\r\n    }\r\n    i18n.prototype.load = function (url) {\r\n        return loadJson(this.baseURL + url + '.' + this.suffix);\r\n    };\r\n    i18n.prototype.setLanguage = function (locale, language) {\r\n        var _this = this;\r\n        this.locale = locale;\r\n        if (language) {\r\n            i18n.langMap[locale] = language;\r\n        }\r\n        return new Promise(function (resolve, reject) {\r\n            _this.run.bind(_this)(function () {\r\n                _this.re();\r\n                resolve(_this.langlib);\r\n            }, reject);\r\n        });\r\n    };\r\n    i18n.prototype.then = function (callback) {\r\n        this.run(callback, callback);\r\n        return this;\r\n    };\r\n    i18n.prototype.run = function (success, error) {\r\n        var _this = this;\r\n        if (i18n.langMap[this.locale]) {\r\n            this.langlib = i18n.langMap[this.locale];\r\n            success && success(this.langlib);\r\n        }\r\n        else {\r\n            this.load(this.locale).then(function (d) {\r\n                _this.langlib = i18n.langMap[_this.locale] = d;\r\n                success && success(_this.langlib);\r\n            }).catch(function (err) {\r\n                error && error(err);\r\n            });\r\n        }\r\n    };\r\n    i18n.prototype.destroy = function () {\r\n        i18n.langMap = {};\r\n        this.langlib = null;\r\n        this.locale = null;\r\n        this.baseURL = null;\r\n    };\r\n    i18n.prototype.t = function (s, setting) {\r\n        var list = s.split('.');\r\n        var o = this.langlib;\r\n        var _loop_1 = function (i, L) {\r\n            var k = list[i];\r\n            if (i < L && /\\[(\\w+)\\]$/.test(k)) {\r\n                var x_1;\r\n                var _k = k.replace(/\\[(\\w+)\\]/, function (match, $1) {\r\n                    x_1 = $1;\r\n                    return '';\r\n                });\r\n                o = o[_k][x_1];\r\n            }\r\n            else {\r\n                o = o[k];\r\n            }\r\n        };\r\n        for (var i = 0, L = list.length; i < L; i++) {\r\n            _loop_1(i, L);\r\n        }\r\n        if (setting) {\r\n            return o.replace(/{(\\w+)}/g, function (match, $1) {\r\n                return setting[$1] || match;\r\n            });\r\n        }\r\n        else {\r\n            return o;\r\n        }\r\n    };\r\n    i18n.prototype.h = function (s, setting) {\r\n        if (setting === void 0) { setting = {}; }\r\n        var hands = this.t(s, setting);\r\n        return \"<\" + this.elTag + \" data-i18n-key=\\\"\" + s + \"\\\" data-i18n-opt=\\\"\" + JSON.stringify(setting) + \"\\\">\" + hands + \"</\" + this.elTag + \">\";\r\n    };\r\n    i18n.prototype.re = function () {\r\n        var _this = this;\r\n        var fonts = document.querySelectorAll(this.elTag + \"[data-i18n-key]\");\r\n        Array.from(fonts).forEach(function (el) {\r\n            var key = el.getAttribute('data-i18n-key');\r\n            var opt = el.getAttribute('data-i18n-opt');\r\n            el.innerText = _this.t(key, JSON.parse(opt));\r\n        });\r\n    };\r\n    i18n.langMap = {};\r\n    return i18n;\r\n}());\r\n/**\r\n * 同步\r\n\r\n\r\nconst i18 = new i18n({\r\n    locale: 'en',\r\n    messages: {\r\n        en: require('./en.json')\r\n    },\r\n    baseURL: '/lang/',\r\n})\r\n\r\n *\r\n */\r\n/**\r\n * const body = document.querySelector('body');\r\nconst i18 = new i18n({\r\n    //locale: 'en',\r\n    // messages: {\r\n    //     en: require('./en.json')\r\n    // },\r\n    baseURL: '/lang/',\r\n    suffix: 'js'\r\n})\r\n *\r\nimport('./en').then((d)=>{\r\n    i18.setLanguage('en',d).then(()=>{\r\n        console.time('num')\r\n        body.innerHTML = i18.h('内容[1]');\r\n        console.timeEnd('num')\r\n    });\r\n    \r\n})\r\n\r\n*/\r\nexport default i18n;\r\n","export default function (url) {\r\n    return new Promise(function (resolve, reject) {\r\n        if (!/.json$/.test(url)) {\r\n            window.module = window.module || {};\r\n            var script = document.createElement('script');\r\n            script.type = 'text/javascript';\r\n            script.src = url;\r\n            document.head.appendChild(script);\r\n            script.onload = function (a) {\r\n                var _export = window.module.exports;\r\n                if (_export) {\r\n                    resolve(_export);\r\n                }\r\n                ;\r\n                script.onload = script.onerror = null;\r\n                script.remove();\r\n                delete window.module;\r\n            };\r\n            script.onerror = function () {\r\n                script.onload = script.onerror = null;\r\n                script.remove();\r\n                delete window.module;\r\n                reject({\r\n                    status: 404,\r\n                    statusText: \"get \" + url + \" error\"\r\n                });\r\n            };\r\n        }\r\n        else {\r\n            var rawFile = new XMLHttpRequest();\r\n            rawFile.overrideMimeType(\"application/json\");\r\n            rawFile.open(\"GET\", url, true);\r\n            rawFile.onreadystatechange = function () {\r\n                if (rawFile.readyState === 4 && rawFile.status == \"200\") {\r\n                    resolve(JSON.parse(rawFile.responseText));\r\n                }\r\n                else if (rawFile.readyState === 4 && rawFile.status >= 400) {\r\n                    reject({\r\n                        status: rawFile.status,\r\n                        statusText: rawFile.statusText\r\n                    });\r\n                }\r\n            };\r\n            rawFile.send();\r\n        }\r\n    });\r\n}\r\n"],"sourceRoot":""}